<?xml version="1.0" encoding="utf-8"?>
    <Page
    x:Class="App_3.Views.ItemsManagementPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:models="using:App_3.Models"
    xmlns:converters="using:App_3.Converters"
    Background="#F5F7FA">

    <Page.Resources>
        <converters:ItemStockConverter x:Key="StockConverter"/>

        <!-- Soft gradient for buttons -->
        <LinearGradientBrush x:Key="SoftGradient" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#FF4C6FFF" Offset="0"/>
            <GradientStop Color="#FF74D1E4" Offset="1"/>
        </LinearGradientBrush>

        <!-- Glass/frosted background -->
        <SolidColorBrush x:Key="GlassFill" Color="#CCFFFFFF"/>
        <SolidColorBrush x:Key="GlassBorder" Color="#40FFFFFF"/>
        <SolidColorBrush x:Key="CardBackground" Color="#FFFFFFFF"/>
        <SolidColorBrush x:Key="MutedText" Color="#64748B"/>
        <SolidColorBrush x:Key="HeaderTextBrush" Color="#0F172A"/>

        <!-- Metric card -->
        <Style x:Key="MetricCard" TargetType="Border">
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="12"/>
            <Setter Property="Margin" Value="6"/>
            <Setter Property="Width" Value="220"/>
            <Setter Property="Height" Value="92"/>
            <Setter Property="Background" Value="{StaticResource GlassFill}"/>
            <Setter Property="BorderBrush" Value="{StaticResource GlassBorder}"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>

        <!-- Row card -->
        <Style x:Key="RowCard" TargetType="Border">
            <Setter Property="CornerRadius" Value="10"/>
            <Setter Property="Padding" Value="12"/>
            <Setter Property="Margin" Value="0,8,0,8"/>
            <Setter Property="Background" Value="{StaticResource GlassFill}"/>
            <Setter Property="BorderBrush" Value="{StaticResource GlassBorder}"/>
            <Setter Property="BorderThickness" Value="0.8"/>
        </Style>

        <!-- Chips -->
        <Style x:Key="ChipAvailable" TargetType="Border">
            <Setter Property="Background" Value="#FF22C55E"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="8,4"/>
        </Style>
        <Style x:Key="ChipLow" TargetType="Border">
            <Setter Property="Background" Value="#FFEF4444"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="8,4"/>
        </Style>

        <!-- Buttons -->
        <Style x:Key="PrimaryButton" TargetType="Button">
            <Setter Property="Padding" Value="10,6"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Background" Value="{StaticResource SoftGradient}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
        </Style>
        <Style x:Key="OutlineButton" TargetType="Button">
            <Setter Property="Padding" Value="10,6"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Background" Value="#00FFFFFF"/>
            <Setter Property="Foreground" Value="#0F172A"/>
            <Setter Property="BorderBrush" Value="#20000000"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>

        <!-- Text styles -->
        <Style x:Key="HeaderText" TargetType="TextBlock">
            <Setter Property="FontSize" Value="26"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="{StaticResource HeaderTextBrush}"/>
        </Style>
        <Style x:Key="SubText" TargetType="TextBlock">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Foreground" Value="{StaticResource MutedText}"/>
        </Style>
        <Style x:Key="TableHeaderText" TargetType="TextBlock">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="#334155"/>
        </Style>
    </Page.Resources>

    <Grid Padding="22">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="320"/>
            </Grid.ColumnDefinitions>

            <StackPanel Orientation="Vertical">
                <TextBlock Text="Items" Style="{StaticResource HeaderText}"/>
                <TextBlock Text="Manage inventory quickly &amp; efficiently" Style="{StaticResource SubText}" Margin="0,6,0,0"/>
            </StackPanel>

            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Grid.Column="1" Spacing="8">
                <Button Content="Import" Style="{StaticResource OutlineButton}"/>
                <Button Content="Export" Style="{StaticResource OutlineButton}"/>
                <Button Content="+ Add Item" Style="{StaticResource PrimaryButton}"/>
            </StackPanel>
        </Grid>

        <!-- Metrics + Search -->
        <Grid Grid.Row="1" Margin="0,18,0,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Metric cards -->
            <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Spacing="8">
                <Border Style="{StaticResource MetricCard}">
                    <StackPanel>
                        <TextBlock Text="Total Items" FontSize="12" Foreground="#334155"/>
                        <TextBlock x:Name="TotalItemsText" Text="0" FontSize="22" FontWeight="Bold" Margin="0,6,0,0"/>
                    </StackPanel>
                </Border>

                <Border Style="{StaticResource MetricCard}">
                    <StackPanel>
                        <TextBlock Text="Low Stock" FontSize="12" Foreground="#334155"/>
                        <TextBlock x:Name="LowStockText" Text="0" FontSize="22" FontWeight="Bold" Margin="0,6,0,0"/>
                    </StackPanel>
                </Border>

                <Border Style="{StaticResource MetricCard}">
                    <StackPanel>
                        <TextBlock Text="Total Value" FontSize="12" Foreground="#334155"/>
                        <TextBlock x:Name="TotalValueText" Text="₹0" FontSize="22" FontWeight="Bold" Margin="0,6,0,0"/>
                    </StackPanel>
                </Border>
            </StackPanel>

            <!-- Search & filters -->
            <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right" Spacing="8">
                <TextBox x:Name="SearchBox" Width="340" PlaceholderText="Search by name, code, category…" TextChanged="SearchBox_TextChanged"/>
                <ComboBox x:Name="StockFilterCombo" Width="140" SelectionChanged="StockFilterCombo_SelectionChanged">
                    <ComboBoxItem Content="All"/>
                    <ComboBoxItem Content="Available"/>
                    <ComboBoxItem Content="Low Stock"/>
                </ComboBox>
                <ComboBox x:Name="SortCombo" Width="120" SelectionChanged="SortCombo_SelectionChanged">
                    <ComboBoxItem Content="Newest"/>
                    <ComboBoxItem Content="Oldest"/>
                </ComboBox>
                <Button Content="Reset" Style="{StaticResource OutlineButton}" Click="ResetFilters_Click"/>
            </StackPanel>
        </Grid>

        <!-- Main content -->
        <Grid Grid.Row="2" ColumnSpacing="16">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="3*"/>
                <ColumnDefinition Width="1.18*"/>
            </Grid.ColumnDefinitions>

            <!-- Left: table/list -->
            <Border CornerRadius="12" Background="{StaticResource CardBackground}" Padding="12">
                <StackPanel>
                    <!-- Columns header -->
                    <Grid Margin="6" ColumnSpacing="12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="2*"/>
                            <ColumnDefinition Width="1.2*"/>
                            <ColumnDefinition Width="1.6*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="120"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Column="0" Text="Name" Style="{StaticResource TableHeaderText}"/>
                        <TextBlock Grid.Column="1" Text="Code" Style="{StaticResource TableHeaderText}"/>
                        <TextBlock Grid.Column="2" Text="Category" Style="{StaticResource TableHeaderText}"/>
                        <TextBlock Grid.Column="3" Text="Price" Style="{StaticResource TableHeaderText}"/>
                        <TextBlock Grid.Column="4" Text="Stock / Actions" Style="{StaticResource TableHeaderText}" HorizontalAlignment="Right"/>
                    </Grid>

                    <ScrollViewer Height="520" VerticalScrollBarVisibility="Auto">
                        <ItemsControl x:Name="ItemsListView" Margin="0,8,0,12">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate x:DataType="models:ManagedItem">
                                    <Border Style="{StaticResource RowCard}">
                                        <Grid ColumnSpacing="12">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="2*"/>
                                                <ColumnDefinition Width="1.2*"/>
                                                <ColumnDefinition Width="1.6*"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="120"/>
                                            </Grid.ColumnDefinitions>

                                            <TextBlock Grid.Column="0" Text="{x:Bind Name}" VerticalAlignment="Center"/>
                                            <TextBlock Grid.Column="1" Text="{x:Bind Code}" VerticalAlignment="Center"/>
                                            <TextBlock Grid.Column="2" Text="{x:Bind Category}" VerticalAlignment="Center"/>
                                            <TextBlock Grid.Column="3" Text="{x:Bind Price}" VerticalAlignment="Center"/>

                                            <StackPanel Grid.Column="4" Orientation="Horizontal" HorizontalAlignment="Right" Spacing="8">
                                                <Border Style="{StaticResource ChipAvailable}" VerticalAlignment="Center" Visibility="{x:Bind IsLowStock, Converter={StaticResource StockConverter}, ConverterParameter=Available}">
                                                    <TextBlock Text="Available" Foreground="White" FontSize="12" Margin="8,0"/>
                                                </Border>
                                                <Border Style="{StaticResource ChipLow}" VerticalAlignment="Center" Visibility="{x:Bind IsLowStock, Converter={StaticResource StockConverter}, ConverterParameter=Low}">
                                                    <TextBlock Text="Low Stock" Foreground="White" FontSize="12" Margin="8,0"/>
                                                </Border>
                                                <Button Content="Edit" Width="64"/>
                                                <Button Content="Delete" Width="64"/>
                                            </StackPanel>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                </StackPanel>
            </Border>

            <!-- Right Panel -->
            <Border Grid.Column="1" CornerRadius="12" Padding="12" Background="{StaticResource GlassFill}" BorderBrush="{StaticResource GlassBorder}" BorderThickness="1">
                <StackPanel Spacing="12">
                    <TextBlock Text="Quick Actions" FontWeight="SemiBold" FontSize="14"/>
                    <Button Content="Restock" Style="{StaticResource PrimaryButton}"/>
                    <Button Content="Export CSV" Style="{StaticResource OutlineButton}"/>
                    <Button Content="Bulk Delete" Style="{StaticResource OutlineButton}"/>

                    <Rectangle Height="1" Fill="#0D374151" Opacity="0.08" Margin="0,6"/>

                    <TextBlock Text="Item Preview" FontWeight="SemiBold" FontSize="14"/>
                    <StackPanel Background="#00FFFFFF" Padding="6" CornerRadius="8">
                        <TextBlock x:Name="PreviewText" Text="Select an item to preview details" FontSize="12" Foreground="{StaticResource MutedText}"/>
                    </StackPanel>
                </StackPanel>
            </Border>
        </Grid>
    </Grid>
</Page>
