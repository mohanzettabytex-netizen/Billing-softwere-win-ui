<Page
    x:Class="App_3.Views.ItemsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Background="#F3F4F6">

    <Grid>

        <!-- ================= EMPTY STATE (FULL PAGE) ================= -->
        <Grid x:Name="EmptyState"
              Background="#F3F4F6"
              Visibility="Visible">

            <StackPanel HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Spacing="20"
                        Width="420">

                <Border Width="96" Height="96"
                        CornerRadius="24"
                        Background="#E0E7FF"
                        HorizontalAlignment="Center">
                    <SymbolIcon Symbol="Shop"
                                Foreground="#2563EB"
                                Width="40"
                                Height="40"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"/>
                </Border>

                <TextBlock Text="No items added yet"
                           FontSize="22"
                           FontWeight="SemiBold"
                           TextAlignment="Center"/>

                <TextBlock Text="Create products or services to start billing your customers"
                           FontSize="14"
                           Foreground="#64748B"
                           TextAlignment="Center"
                           TextWrapping="Wrap"/>

                <Button Content="+ Add Your First Item"
                        Height="48"
                        FontSize="16"
                        Background="#2563EB"
                        Foreground="White"
                        CornerRadius="12"
                        Click="EmptyStateAddItem_Click"/>
            </StackPanel>
        </Grid>

        <!-- ================= MAIN CONTENT ================= -->
        <ScrollViewer x:Name="MainContent"
                      Visibility="Collapsed">
            <StackPanel Padding="24" Spacing="20">

                <!-- HEADER -->
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel>
                        <TextBlock Text="Items" FontSize="28" FontWeight="Bold" Foreground="#0F172A"/>
                        <TextBlock Text="Manage products &amp; services, stock &amp; pricing" FontSize="13" Foreground="#64748B" Margin="0,6,0,0"/>
                    </StackPanel>

                    <!-- BULK IMPORT / EXPORT + ADD ITEM -->
                    <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8">
                        <Button Content="â¬† Import" Padding="12,8" CornerRadius="8" Click="ImportItems"/>
                        <Button Content="â¬‡ Export" Padding="12,8" CornerRadius="8" Click="ExportItems"/>
                        <Button Content="+ Add Item" Padding="14,8" Background="#2563EB" Foreground="White" CornerRadius="8" Click="OpenAddItemPopup"/>
                    </StackPanel>
                </Grid>

                <!-- ================= SUMMARY CARDS ================= -->
                <Grid ColumnSpacing="16" Margin="0,16,0,16">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition/>
                        <ColumnDefinition/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>

                    <!-- TOTAL ITEMS -->
                    <Border Background="White" CornerRadius="16" Padding="20">
                        <StackPanel>
                            <TextBlock Text="Total Items" Foreground="#64748B"/>
                            <TextBlock x:Name="TxtTotalItems" Text="0" FontSize="22" FontWeight="Bold" Foreground="#0F172A"/>
                        </StackPanel>
                    </Border>

                    <!-- PRODUCTS -->
                    <Border Grid.Column="1" Background="White" CornerRadius="16" Padding="20">
                        <StackPanel>
                            <TextBlock Text="Products" Foreground="#64748B"/>
                            <TextBlock x:Name="TxtProducts" Text="0" FontSize="22" FontWeight="Bold" Foreground="#15803D"/>
                        </StackPanel>
                    </Border>

                    <!-- SERVICES -->
                    <Border Grid.Column="2" Background="White" CornerRadius="16" Padding="20">
                        <StackPanel>
                            <TextBlock Text="Services" Foreground="#64748B"/>
                            <TextBlock x:Name="TxtServices" Text="0" FontSize="22" FontWeight="Bold" Foreground="#0C4A6E"/>
                        </StackPanel>
                    </Border>

                    <!-- LOW STOCK -->
                    <Border Grid.Column="3" Background="White" CornerRadius="16" Padding="20">
                        <StackPanel>
                            <TextBlock Text="Low Stock" Foreground="#64748B"/>
                            <TextBlock x:Name="TxtLowStock" Text="0" FontSize="22" FontWeight="Bold" Foreground="#B91C1C"/>
                        </StackPanel>
                    </Border>
                </Grid>


                <!-- ================= SEARCH & FILTER ================= -->
                <Border Background="White" CornerRadius="12" Padding="16">
                    <StackPanel Orientation="Horizontal" Spacing="16" MaxWidth="760" HorizontalAlignment="Left">

                        <!-- SEARCH BOX -->
                        <Grid Width="280">
                            <TextBox x:Name="SearchBox"
                     PlaceholderText="Search item name or code"
                     Padding="36,10,12,10"
                     CornerRadius="8"
                     FontSize="14"
                     Height="40"/>
                            <SymbolIcon Symbol="Find"
                        Foreground="#64748B"
                        Width="18"
                        Height="18"
                        Margin="12,0,0,0"
                        VerticalAlignment="Center"
                        HorizontalAlignment="Left"
                        IsHitTestVisible="False"/>
                        </Grid>

                        <!-- FILTER STOCK STATUS -->
                        <ComboBox x:Name="FilterStock"
                  Width="160"
                  Height="40"
                  PlaceholderText="Stock Status"
                  CornerRadius="8"
                  FontSize="14">
                            <ComboBoxItem Content="All"/>
                            <ComboBoxItem Content="In Stock"/>
                            <ComboBoxItem Content="Low Stock"/>
                            <ComboBoxItem Content="Out of Stock"/>
                        </ComboBox>

                        <!-- FILTER TYPE -->
                        <ComboBox x:Name="FilterType"
                  Width="160"
                  Height="40"
                  PlaceholderText="Type"
                  CornerRadius="8"
                  FontSize="14">
                            <ComboBoxItem Content="All"/>
                            <ComboBoxItem Content="Product"/>
                            <ComboBoxItem Content="Service"/>
                        </ComboBox>

                    </StackPanel>
                </Border>


                <Border Background="White" CornerRadius="12" Padding="12">
                    <!-- Use StackPanel as single child of Border -->
                    <StackPanel>

                        <!-- HEADER -->
                        <Grid Background="#F8FAFC" Padding="8" Margin="0,0,0,6">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Text="Item" FontWeight="SemiBold"/>
                            <TextBlock Text="Type" Grid.Column="1" FontWeight="SemiBold"/>
                            <TextBlock Text="SKU" Grid.Column="2" FontWeight="SemiBold"/>
                            <TextBlock Text="Sale Price" Grid.Column="3" FontWeight="SemiBold"/>
                            <TextBlock Text="Purchase" Grid.Column="4" FontWeight="SemiBold"/>
                            <TextBlock Text="Stock" Grid.Column="5" FontWeight="SemiBold"/>
                            <TextBlock Text="Unit" Grid.Column="6" FontWeight="SemiBold"/>
                            <TextBlock Text="Status" Grid.Column="7" FontWeight="SemiBold"/>
                            <TextBlock Text="Actions" Grid.Column="8" FontWeight="SemiBold"/>
                        </Grid>

                        <!-- SCROLLABLE LIST -->
                        <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto" Height="400">
                            <ListView x:Name="ItemsList">
                                <ListView.ItemTemplate>
                                    <DataTemplate>
                                        <Grid Padding="8">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="2*"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>

                                            <!-- ITEM -->
                                            <StackPanel Orientation="Horizontal" Spacing="10">
                                                <Border Width="36" Height="36" CornerRadius="8" Background="#E5E7EB">
                                                    <Image Source="{Binding ImagePath}" Stretch="UniformToFill"/>
                                                </Border>
                                                <TextBlock Text="{Binding Name}" VerticalAlignment="Center"/>
                                            </StackPanel>

                                            <!-- TYPE -->
                                            <TextBlock Grid.Column="1" Text="{Binding Type}" VerticalAlignment="Center"/>
                                            <TextBlock Grid.Column="2" Text="{Binding SKU}" VerticalAlignment="Center"/>
                                            <TextBlock Grid.Column="3" Text="{Binding SalePrice}" VerticalAlignment="Center"/>
                                            <TextBlock Grid.Column="4" Text="{Binding PurchasePrice}" VerticalAlignment="Center"/>
                                            <TextBlock Grid.Column="5" Text="{Binding StockQty}" VerticalAlignment="Center"/>
                                            <TextBlock Grid.Column="6" Text="{Binding Unit}" VerticalAlignment="Center"/>

                                            <!-- STATUS -->
                                            <Border Grid.Column="7"
                                    Background="{Binding StatusColor}"
                                    CornerRadius="12"
                                    Padding="8,3"
                                    HorizontalAlignment="Left">
                                                <TextBlock Text="{Binding Status}"
                                           FontSize="12"
                                           FontWeight="SemiBold"
                                           Foreground="{Binding StatusTextColor}"/>
                                            </Border>

                                            <!-- ACTIONS -->
                                            <StackPanel Grid.Column="8" Orientation="Horizontal" Spacing="8" HorizontalAlignment="Center">
                                                <Button Content="âœï¸" Padding="6" CornerRadius="6" Click="EditItem_Click"/>
                                                <Button Content="ðŸ—‘" Padding="6" CornerRadius="6"/>
                                            </StackPanel>

                                        </Grid>
                                    </DataTemplate>
                                </ListView.ItemTemplate>
                            </ListView>
                        </ScrollViewer>

                    </StackPanel>
                </Border>



            </StackPanel>
        </ScrollViewer>
        <!-- ================= ADD ITEM OVERLAY ================= -->
        <Grid x:Name="AddItemOverlay"
              Background="#80000000"
              Visibility="Collapsed">
            <Border Width="450"
                    Background="White"
                    CornerRadius="16"
                    Padding="24"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Spacing="16">

                        <TextBlock Text="Add Item" FontSize="22" FontWeight="SemiBold"/>

                        <!-- TYPE SELECTOR -->
                        <StackPanel>
                            <TextBlock Text="Type *" Foreground="Red" FontSize="12"/>
                            <ComboBox x:Name="AddItemType" CornerRadius="8" SelectionChanged="AddItemType_SelectionChanged">
                                <ComboBoxItem Content="Product"/>
                                <ComboBoxItem Content="Service"/>
                            </ComboBox>
                        </StackPanel>

                        <!-- IMAGE UPLOAD -->
                        <StackPanel HorizontalAlignment="Center" Spacing="12">
                            <Border Width="120" Height="120" CornerRadius="12" Background="#E5E7EB">
                                <Image x:Name="AddItemImage" Stretch="UniformToFill"/>
                            </Border>
                            <Button Content="Upload Image" Padding="12,6" CornerRadius="8"/>
                        </StackPanel>

                        <!-- FORM FIELDS -->
                        <StackPanel x:Name="AddItemFields" Spacing="12">
                            <TextBox x:Name="AddItemName" PlaceholderText="Item Name*" Height="40" CornerRadius="8"/>
                            <TextBox x:Name="AddItemSalePrice" PlaceholderText="Sale Price*" Height="40" CornerRadius="8"/>
                            <TextBox x:Name="AddItemSKU" PlaceholderText="SKU" Height="40" CornerRadius="8"/>
                            <TextBox x:Name="AddItemPurchasePrice" PlaceholderText="Purchase Price" Height="40" CornerRadius="8"/>
                            <TextBox x:Name="AddItemStock" PlaceholderText="Stock Qty" Height="40" CornerRadius="8"/>
                            <ComboBox x:Name="AddItemUnit" Height="40" CornerRadius="8">
                                <ComboBoxItem Content="pcs"/>
                                <ComboBoxItem Content="kg"/>
                                <ComboBoxItem Content="ltr"/>
                            </ComboBox>
                            <TextBox x:Name="AddItemTax" PlaceholderText="Tax %" Height="40" CornerRadius="8"/>
                            <TextBox x:Name="AddItemHSN" PlaceholderText="HSN Code" Height="40" CornerRadius="8"/>
                            <TextBox x:Name="AddItemDescription" PlaceholderText="Description" Height="80" AcceptsReturn="True" CornerRadius="8"/>
                        </StackPanel>

                        <!-- ACTION BUTTONS -->
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Spacing="12" Margin="0,16,0,0">
                            <Button Content="Cancel" Width="100" CornerRadius="8" Click="CloseAddItemPopup"/>
                            <Button Content="Save Item" Width="120" Background="#2563EB" Foreground="White" CornerRadius="8" Click="SaveNewItem"/>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>

        <!-- ================= EDIT ITEM OVERLAY ================= -->
        <Grid x:Name="EditItemOverlay"
              Background="#80000000"
              Visibility="Collapsed">
            <Border Width="450"
                    Background="White"
                    CornerRadius="16"
                    Padding="24"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Spacing="16">

                        <TextBlock Text="Edit Item" FontSize="22" FontWeight="SemiBold"/>

                        <!-- TYPE SELECTOR -->
                        <StackPanel>
                            <TextBlock Text="Type *" Foreground="Red" FontSize="12"/>
                            <ComboBox x:Name="EditItemType" CornerRadius="8">
                                <ComboBoxItem Content="Product"/>
                                <ComboBoxItem Content="Service"/>
                            </ComboBox>
                        </StackPanel>

                        <!-- IMAGE UPLOAD -->
                        <StackPanel HorizontalAlignment="Center" Spacing="12">
                            <Border Width="120" Height="120" CornerRadius="12" Background="#E5E7EB">
                                <Image x:Name="EditItemImage" Stretch="UniformToFill"/>
                            </Border>
                            <Button Content="Upload Image" Padding="12,6" CornerRadius="8"/>
                        </StackPanel>

                        <!-- FORM FIELDS -->
                        <StackPanel Spacing="12">
                            <TextBox x:Name="EditItemName" PlaceholderText="Item Name*" Height="40" CornerRadius="8"/>
                            <TextBox x:Name="EditItemSalePrice" PlaceholderText="Sale Price*" Height="40" CornerRadius="8"/>
                            <TextBox x:Name="EditItemSKU" PlaceholderText="SKU" Height="40" CornerRadius="8"/>
                            <TextBox x:Name="EditItemPurchasePrice" PlaceholderText="Purchase Price" Height="40" CornerRadius="8"/>
                            <TextBox x:Name="EditItemStock" PlaceholderText="Stock Qty" Height="40" CornerRadius="8"/>
                            <ComboBox x:Name="EditItemUnit" Height="40" CornerRadius="8">
                                <ComboBoxItem Content="pcs"/>
                                <ComboBoxItem Content="kg"/>
                                <ComboBoxItem Content="ltr"/>
                            </ComboBox>
                            <TextBox x:Name="EditItemTax" PlaceholderText="Tax %" Height="40" CornerRadius="8"/>
                            <TextBox x:Name="EditItemHSN" PlaceholderText="HSN Code" Height="40" CornerRadius="8"/>
                            <TextBox x:Name="EditItemDescription" PlaceholderText="Description" Height="80" AcceptsReturn="True" CornerRadius="8"/>
                        </StackPanel>

                        <!-- ACTION BUTTONS -->
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Spacing="12" Margin="0,16,0,0">
                            <Button Content="Cancel" Width="100" CornerRadius="8" Click="CloseEditItemPopup"/>
                            <Button Content="Update Item" Width="120" Background="#2563EB" Foreground="White" CornerRadius="8" Click="UpdateItem"/>
                        </StackPanel>

                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>
    </Grid>
</Page>
